---
title: "TareaETS_Eddie"
author: "Eddie Aguilar"
format: 
  html:
    self-contained: true
editor: visual
---

```{r}
library("tidyverse")
library("fpp3") 
library("patchwork")
library("plotly")
```


Usaré dos series de tiempo:

- Población de Canadá (Sin estacionalidad)
- Producción de cerveza de Australia (Con estacionalidad)

```{r}
autoplot(global_economy %>% filter(Country == "Canada"), Population) + ylab("Population") + xlab("Year")
autoplot(aus_production,  Beer) + ylab("Beer") + xlab("Year")
```

Trabajando primero con la población de Canadá y usando Drift:

```{r}
c_population <- global_economy |> filter(Country == "Canada")
c_m <- c_population |> model(Drift = RW(Population ~ drift())) |> forecast(h = 5)

autoplot(c_m, c_population |> filter_index("2000"~.), level = NULL)
```

Comparando con Holt y Damped Holt:

```{r}
c_f_ets <- c_population |> model(Holt = ETS(Population ~ error("A") + trend("A")),
                                 Damped_Holt = ETS(Population ~ error("A") + trend("Ad")),
                                 Drift = RW(Population ~ drift())) 

c_m_ets <- c_f_ets |> forecast(h = 5)

autoplot(c_m_ets, c_population |> filter_index("2000"~.), level = NULL)
```

```{r}
  arrange(select(accuracy(c_f_ets), .model, .type, MAE, RMSE, MAPE, MASE), MAE)
```

Como podemos ver, Damped Holt es el que tiene el menor error:

```{r}
c_dholt <- c_population |> model(Damped_Holt = ETS(Population ~ error("A") + trend("Ad"))) |> forecast(h = 5)
autoplot(c_dholt, c_population |> filter_index("2000"~.))
```

Trabajando con estacionalidad, producción de cerveza en Australia y Seasonal Naive:

```{r}
beer <- aus_production
beer_m <- beer |> model(snaive = SNAIVE(Beer)) |> forecast(h = 5)

autoplot(beer_m, beer |> filter_index("2000"~.))
```

Comparando con ETS aditivo y multiplicativo:

```{r}
beer_f_ets <- beer |> model(snaive = SNAIVE(Beer), 
                            additive = ETS(Beer ~ error("A") + trend("A") + season("A")),
                            mult = ETS(Beer ~ error("M") + trend("A") + season("M")))

beer_m_ets <- beer_f_ets |> forecast(h = 5)

beer_m_ets |> autoplot(aus_production |> filter_index("2000"~.), level = NULL)
```

Errores:

```{r}
arrange(select(accuracy(beer_f_ets), .model, .type, MAE, RMSE, MAPE, MASE), MAE)
```

Como podemos ver el menor error presentado fue por multiplicativo:

```{r}
beer_mul <- beer |> model(mult = ETS(Beer ~ error("M") + trend("A") + season("M"))) |> forecast(h = 5)

beer_mul |> autoplot(aus_production |> filter_index("2000"~.), level = NULL)
```

